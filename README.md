# Задание 1. Анализ и планирование

### 1. Описание функциональности монолитного приложения

**Управление отоплением:**

- Пользователи могут удаленно включать/выключать отопление в своих домах.
- Система включает/выключает устройства отопления в домах пользователей.

**Мониторинг температуры:**

- Пользователи могут просматривать текущую температуру в своих домах через веб-интерфейс.
- Система получает данные о температуре с датчиков, установленных в домах.

### 2. Анализ архитектуры монолитного приложения

- Язык программирования: Go
- База данных: PostgreSQL
- Архитектура: Монолитная, все компоненты системы (обработка запросов, бизнес-логика, работа с данными) находятся в рамках одного приложения.
- Взаимодействие: Синхронное, запросы обрабатываются последовательно.
- Масштабируемость: Ограничена, так как монолит сложно масштабировать по частям.
- Развертывание: Требует остановки всего приложения.

### 3. Определение доменов и границы контекстов

- Домен «Управление устройствами отопления»
	- поддомен управления устройствами отопления
		- контекст: включение/выключение устройств отопления
- Домен «Мониторинг»
	- поддомен управления датчиками
		- контекст: получение данных с датчиков
		- контекст: отображение данных с датчиком через веб-интерфейс

- Домен «Веб-приложение»
	- поддомен взаимодействия пользователя и системы

### **4. Проблемы монолитного решения**

- Низкая скорость обработки запросов из-за синхронности
- Ограниченная масштабируемость — трудно масштабировать отдельные компоненты системы
- Развертывание требует остановки всего приложения — разработка затрудняется и замедляется
- Сложность при внесении изменений
- Трудно управлять командой
- Высокий риск ошибок
- Сбой в одном модуле может привести к сбою всего приложения

### 5. Визуализация контекста системы — диаграмма С4
 
[Диаграмма контекста системы WarmHouse («Тёплый дом»)](schemas/C4_Context/WarmHouse_C4_Context.png)
 
# Задание 2. Проектирование микросервисной архитектуры

**Диаграмма контейнеров (Containers)**

[Диаграмма контейнеров SmartHome («Умный дом») с интеграцией монолита (MVP)](schemas/C4_Container/SmartHome_C4_Container.png)

**Диаграмма компонентов (Components)**

[Диаграмма компонентов Web App SmartHome API](schemas/C4_Component/SmartHome_C4_Component_Web_App.png)

[Диаграмма компонентов Device Service](schemas/C4_Component/SmartHome_C4_Component_Device_Service.png)

[Диаграмма компонентов Telemetry Service](schemas/C4_Component/SmartHome_C4_Component_Telemetry_Service.png)

**Диаграмма кода (Code)**

[Диаграмма кода Telemetry Service](schemas/C4_Code/SmartHome_C4_Code_Telemetry_Service.png)

# Задание 3. Разработка ER-диаграммы

[ER-диаграмма системы SmartHome](schemas/ER/SmartHome_ER.png)

# Задание 4. Создание и документирование API

### 1. Тип API

Для взаимодействия микросервисов был выбран REST API по следующим причинам:
- Знакомый тип API, который уже используется в рабочих проектах, поэтому хорошо понятен
- Спроектированным мною микросервисам требуется немедленный ответ на запрос, для чего подходит именно REST API
- Простота реализации, подойдет для получившейся архитектуры
- Наличие подробной и удобной документации, которую легко составить и понять другим разработчикам

### 2. Документация API

[Swagger документация системы SmartHome](docs/SmartHome_Swagger.yaml)

# Задание 5. Работа с docker и docker-compose

[Dockerfile (temperature-api)](apps\temperature-api\Dockerfile)

[docker-compose](apps\docker-compose.yml)

# **Задание 6. Разработка MVP**

[Dockerfile (telemetry-service)](apps\telemetry-service\Dockerfile) — сервис, отвечающий за взаимодействие с телеметрией, опрашивает датчики и получает их значения.

[Dockerfile (device-service)](apps\device-service\Dockerfile) — сервис, отвечающий за взаимодействие с устройствами пользователя.

[Dockerfile (smarthome-api)](apps\smarthome-api\Dockerfile) — сервис, отвечающий за взаимодействие с пользователем, также перенаправляет запросы в другие микросервисы.

[docker-compose](apps\docker-compose.yml)

Взаимодействие с монолитом реализовано по следующей логике: так как нужно сохранить все его функции, пока пусть устройства и датчики для системы отопления будут связаны с монолитом и иметь отдельные сущности. Для новых устройств и датчиков были разработаны новые микросервисы и созданы новые сущности в базе данных.